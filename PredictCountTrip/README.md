# pyspark_PredictCountTrip

Цель проекта: Построить ML модель на Spark предсказания количества заказов на следующий час для каждого района В рамках этого было проведено исследование имеющихся данных, подготовлен набор признаков для обучения и обучены модели.

На основании проведенного анализа было принято решение обучить модели по следующим срезам:
 - по всей выборке
 - по районам
 - по макрозонам

В качестве базовых моделей на всей выборке были протестированы:
 - LinearRegression
 - GBTRegressor
 - RandomForestRegressor
 - DecisionTreeRegres
Наиболее оптимальные результаты показали модели градиентного бустинга и линейной регрессии и случайного леса. При этом моделям не удается корректно предсказать количество заказов в пиковую нагрузку.

В рамках тестирования наилучше всего себя показали модели обученные по макрозонам. Если убрать аномальное большое mae по междугородним поездкам, то средняя абсолютная ошибка составит 2,64. По всей выборке mae составил 3,17. По районам - 3,45.

Возможностей улучшения проекта может быть очень много. Здесь мы испробовали т олько самые очевидные.

 - использовать незадействованные признаки (например, идентификатор такси, таксопарки)
 - по имеющимся координатам раздробить на более мелкие районы
 - изучить более подробно тренды, сезонность, цикличность
 - использовать данные о пассажиропотоках и другую общедоступную информацию
 - ARIMA
 - подобрать признаки и гиперпараметры для моделей
 - и т.д...
